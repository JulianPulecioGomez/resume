!function(e){e.fn.ajaxComments=function(){this.submit(function(){e("#submit");var r=e("#respond"),a=e(".comment-list"),t=e("#cancel-comment-reply-link"),o=e("#wp-temp-form-div"),s=e("#respond"),n=e("#commentform");return e(".error-msg").removeClass("show-error").text(""),e("#author").length&&e("#author").validate(),e("#email").length&&e("#email").validateEmail(),e("#comment").validate(),n.hasClass("loadingform")||e("#author").hasClass("error")||e("#email").hasClass("error")||e("#comment").hasClass("error")?e(".error-msg").addClass("show-error").text("One or more fields have an error. Please check and try again."):e.ajax({type:"POST",url:prorez_ajax_comment_params.ajaxurl,data:e(this).serialize()+"&action=prorez_post_ajax_comment",beforeSend:function(e){n.addClass("loadingform")},error:function(e,r,a){if(500==r)alert("Error while adding comment");else if("timeout"==r)alert("Error: Server doesn't respond.");else{var t=e.responseText.split("<p>")[1].split("</p>");alert(t[0])}},success:function(n){a.length>0?r.parent().hasClass("comment")?(r.parent().children(".children").length?r.parent().children(".children").append(n):(n='<ol class="children">'+n+"</ol>",r.parent().append(n)),o.replaceWith(s),t.hide()):a.append(n):(n='<ol class="comment-list">'+n+"</ol>",r.before(e(n))),e("#comment").val("")},complete:function(){n.removeClass("loadingform")}}),!1})},e.extend(e.fn,{validate:function(){return e(this).val().length<3?(e(this).addClass("error"),!1):(e(this).removeClass("error"),!0)},validateEmail:function(){var r=e(this).val();return/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(r)&&""!=r?(e(this).removeClass("error"),!0):(e(this).addClass("error"),!1)}})}(jQuery);